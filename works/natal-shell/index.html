<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="description" content="Dan Motzenbecker :: recent works"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="author" content="Dan Motzenbecker"><link href="/assets/css/oxism.css?v=facdb73e3a4aec3feb01ede7d77d563b" rel="stylesheet" type="text/css"><link href="/assets/images/favicon.png" rel="icon" type="image/png"><link href="/assets/images/favicon-152.png" rel="apple-touch-icon-precomposed"><link href="//fonts.googleapis.com/css?family=Playfair+Display:700" rel="stylesheet" type="text/css"><title>Natal Shell - A thin ClojureScript wrapper around the React Native API</title></head><body class="perma"><nav id="grid"><div id="info"><div><div class="cover"><h1>Dan<br>Motzenbecker</h1><br><h2>recent<br>works</h2></div><div class="image"></div></div></div><div id="meta"><div><div class="cover"><div><a id="email" class="button">email</a><a href="https://twitter.com/dcmotz" class="button">twitter</a><a href="https://github.com/dmotz" class="button">github</a></div></div></div></div><a id="oridomi-link" href="/works/oridomi" class="major"><div><div class="cover"><h2>OriDomi</h2></div><div class="image"></div></div></a><a id="gildedgauge-link" href="/works/gildedgauge" class="major"><div><div class="cover"><h2>Gilded Gauge</h2></div><div class="image"></div></div></a><a id="pozaic-link" href="/works/pozaic" class="major"><div><div class="cover"><h2>Pozaic</h2></div><div class="image"></div></div></a><a id="exifexodus-link" href="/works/exifexodus" class="major"><div><div class="cover"><h2>Exif Exodus</h2></div><div class="image"></div></div></a><a id="cellf-link" href="/works/cellf" class="major"><div><div class="cover"><h2>Cellf</h2></div><div class="image"></div></div></a><a id="chaincal-link" href="/works/chaincal" class="major"><div><div class="cover"><h2>ChainCal</h2></div><div class="image"></div></div></a><a id="hexaflip-link" href="/works/hexaflip" class="major"><div><div class="cover"><h2>HexaFlip</h2></div><div class="image"></div></div></a><a id="maskew-link" href="/works/maskew" class="major"><div><div class="cover"><h2>Maskew</h2></div><div class="image"></div></div></a><a id="turingtype-link" href="/works/turingtype" class="major"><div><div class="cover"><h2>TuringType</h2></div><div class="image"></div></div></a><a id="natal-link" href="/works/natal"><div><div class="cover"><h2>Natal</h2></div></div></a><a id="natal-shell-link" href="/works/natal-shell"><div><div class="cover"><h2>Natal Shell</h2></div></div></a><a id="taxa-link" href="/works/taxa"><div><div class="cover"><h2>ταξα</h2></div></div></a><a id="stream-snitch-link" href="/works/stream-snitch"><div><div class="cover"><h2>stream-snitch</h2></div></div></a><a id="ear-pipe-link" href="/works/ear-pipe"><div><div class="cover"><h2>ear-pipe</h2></div></div></a><a id="statmap-link" href="/works/statmap"><div><div class="cover"><h2>statmap</h2></div></div></a><a id="commune-link" href="/works/commune"><div><div class="cover"><h2>Commune</h2></div></div></a><a id="express-spa-router-link" href="/works/express-spa-router"><div><div class="cover"><h2>Express SPA Router</h2></div></div></a><a id="monocat-link" href="/works/monocat"><div><div class="cover"><h2>Monocat</h2></div></div></a></nav><section id="perma"><div id="perma-content"><a id="x" href="/">&times;</a><main id="content-natal-shell" role="main" class="active"><h1>Natal Shell</h1><h2>A thin ClojureScript wrapper around the React Native API.</h2><div class="buttons"><a href="https://github.com/dmotz/natal-shell" class="button">github</a></div><div class="content"><p>Natal Shell is a simple convenience wrapper around the React Native API,
offering a simple Clojure-ready interface out of the box.</p>
<p>It is designed as a companion library to <a href="https://github.com/dmotz/natal">Natal</a>
(a command line utility for quickly bootstrapping React Native projects in
ClojureScript), but can be used completely independently.</p>
<h2 id="usage">Usage</h2>
<p>Natal Shell exposes React components as macros which you can require like so:</p>
<pre><code class="lang-clojure">(ns future-app.core
  (:require [om.core :as om])
  (:require-macros [natal-shell.components :refer [view text switch-ios image slider-ios]]))
</code></pre>
<p>Use them like this:</p>
<pre><code class="lang-clojure">(text {:style {:color &quot;teal&quot;}} &quot;Well isn&#39;t this nice.&quot;)
</code></pre>
<p>You can pass children as the trailing arguments or as a collection:</p>
<pre><code class="lang-clojure">(view
  nil
  (interleave
    (map #(text nil %) [&quot;un&quot; &quot;deux&quot; &quot;trois&quot;])
    (repeat (switch-ios {:style {:margin 20}})))))
</code></pre>
<p>All component names are normalized in Clojure’s snake-case, for example:</p>
<pre><code class="lang-clojure">;; Using SegmentedControlIOS
(segmented-control-ios {:values [&quot;Emerald&quot; &quot;Sapphire&quot; &quot;Gold&quot;]})
</code></pre>
<p>The same rule applies to API methods.</p>
<p>APIs are divided into separate Clojure namespaces like so:</p>
<pre><code class="lang-clojure">(ns future-app.actions
  (:require-macros [natal-shell.components :refer [text]]
                   [natal-shell.alert-ios :refer [alert prompt]]
                   [natal-shell.push-notification-ios :refer [present-local-notification]]))

(text {:onPress #(alert &quot;Hello from CLJS&quot;)} &quot;press me&quot;)
</code></pre>
<h2 id="error-feedback">Error Feedback</h2>
<p>Natal Shell provides a simple macro called <code>with-error-view</code> that you can wrap around
the body of your component’s <code>render</code> to get visible feedback when an error is thrown:</p>
<pre><code class="lang-clojure">(defui HomeView
  Object
  (render [_]
    (with-error-view
      (view
        nil
        (throw &quot;...&quot;)))))
</code></pre>
<p>A red screen with a stack trace will be shown, making it easier to realize where
something’s gone awry.</p>
<h2 id="coda">Coda</h2>
<p>Natal Shell is automatically generated from scraping the React Native docs via
the script in <code>scripts/scraper.clj</code>.</p>
<p>Future areas of improvement may include optionally omitted prop arguments and
automatic conversion of snake-case keys in maps.</p>
</div><div class="tools">Clojure</div><br class="clear"></main><article id="content-oridomi"><h1>OriDomi</h1><h2>Fold the DOM up like paper.</h2><div class="images"><img src="/assets/images/oridomi1.jpg"><img src="/assets/images/oridomi2.jpg"></div><div class="buttons"><a href="http://oridomi.com" class="button">oridomi.com</a><a href="https://github.com/dmotz/oriDomi" class="button">github</a><a href="http://oridomi.com/docs/oridomi.html" class="button">annotated source</a></div><div class="content"><p>The web is flat, but with OriDomi you can fold it up. Open-source paper-folding
library with animation queueing, touch support, and zero dependencies.</p>
</div><div class="tools">CoffeeScript / JavaScript, CSS3</div><br class="clear"></article><article id="content-gildedgauge"><h1>Gilded Gauge</h1><h2>Visualize relative wealth in graspable terms.</h2><div class="images"><img src="/assets/images/gildedgauge1.jpg"><video autoplay loop src="/assets/images/gildedgauge2.mp4"></video></div><div class="buttons"><a href="http://gildedgauge.club" class="button">gildedgauge.club</a><a href="https://github.com/dmotz/GildedGauge" class="button">github</a></div><div class="content"><p><em>Gilded Gauge</em> is an experiment in visualizing relative wealth in terms viewers
may find more natural to grasp.</p>
<p>Enormous numbers become tangible via comparisons to the Fall of Rome, the distant
future, and cascades of emoji commodities.</p>
<p>Each falling menagerie represents an exact representation of the value in
question, down to the exact dollar.</p>
<p><em>Gilded Gauge</em> is entirely <a href="https://github.com/dmotz/GildedGauge">open source</a>.</p>
</div><div class="tools">Clojure, React, Om</div><br class="clear"></article><article id="content-pozaic"><h1>Pozaic</h1><h2>Capture one second moments as animated gif mosaics.</h2><div class="images"><img src="/assets/images/pozaic1.jpg"><img src="/assets/images/pozaic2.gif"></div><div class="buttons"><a href="https://pozaic.com" class="button">pozaic.com</a></div><div class="content"><p>Pozaic uses WebRTC to connect friends (or strangers) in live video compositions
you can turn into animated gifs. The medium captures a single second in time
across geographic gaps.</p>
</div><div class="tools">Node.js, WebRTC, WebSockets, web workers</div><br class="clear"></article><article id="content-exifexodus"><h1>ExifExodus</h1><h2>Remove GPS data from your photos before you share them online.</h2><div class="buttons"><a href="http://exifexodus.com" class="button">exifexodus.com</a><a href="https://github.com/dmotz/ExifExodus" class="button">github</a></div><div class="content"><h2 id="what-is-exif-">What is EXIF?</h2>
<p><a href="http://en.wikipedia.org/wiki/Exchangeable_image_file_format">EXIF</a>
is a type of metadata that is embedded in photo files from most types
of cameras and phones.</p>
<p>This metadata includes information about the device used to capture the photo,
but also often includes the GPS coordinates of where the photo was taken.</p>
<p>Many users unknowingly share this information with the general public
and site/app owners when uploading photos online.</p>
<p>This has been a common vector of privacy lapses, including cases where
journalists have unintentionally published photos with geotagging data intact.</p>
<p>Recent press has also revealed the NSA&rsquo;s collection of EXIF data in
its <a href="http://en.wikipedia.org/wiki/XKeyscore">XKeyscore</a> program.</p>
<h2 id="what-is-exifexodus-">What is ExifExodus?</h2>
<p>ExifExodus is a small piece of
<a href="https://github.com/dmotz/ExifExodus">open-source code</a> that
runs directly in your browser and strips EXIF data out of your photos before
you upload them.</p>
<h2 id="how-does-it-work-">How does it work?</h2>
<p>You can run ExifExodus whenever you&rsquo;re uploading photos by using its
bookmarklet (available on the <a href="http://exifexodus.com">site</a>)</p>
<p>When ExifExodus encounters a JPG file, it will remove the EXIF data by
copying the pixels to a new image file, similar to taking a screenshot of
something.</p>
<p>Alternatively, you can drop your files in the dropzone at the top of the
<a href="http://exifexodus.com">site</a>) and receive versions free of EXIF data. You can
then save these new files and upload them wherever you&rsquo;d like.</p>
<h2 id="is-exif-without-merit-">Is EXIF without merit?</h2>
<p>That&rsquo;s certainly not the implication of this project. Metadata adds
another dimension to photos and is valuable for preserving context.
This project aims to educate and give users a choice in the matter of sharing
it with specific services (and the web at large).</p>
<h2 id="doesn-rsquo-t-facebook-etc-remove-exif-data-before-displaying-photos-">Doesn&rsquo;t Facebook (etc.) remove EXIF data before displaying photos?</h2>
<p>Yes. Although this prevents the general public from accessing your EXIF data,
you should be aware that the end recipient is free to use or store the metadata
before removing it.</p>
<h2 id="any-caveats-">Any caveats?</h2>
<p>The ExifExodus bookmarklet won&rsquo;t work with any site that uses Flash
(or any other proprietary plugins like Silverlight) to upload files.
For such sites, use the dropzone converter, save the output files, and upload
those instead.</p>
<p>ExifExodus only works with JPG files (which is the most common image
format to carry EXIF metadata).</p>
</div><div class="tools">CoffeeScript / JavaScript, web workers</div><br class="clear"></article><article id="content-cellf"><h1>Cellf</h1><h2>A game of reflection.</h2><div class="buttons"><a href="https://rawgit.com/dmotz/cellf/gh-pages/index.html" class="button">play</a><a href="https://github.com/dmotz/cellf" class="button">github</a></div><div class="content"><p><img src="https://camo.githubusercontent.com/eb5383f02c4367b214bfcf3bb9635b3f52cdc589/687474703a2f2f6f7869736d2e636f6d2f63656c6c662f696d672f63656c6c662e737667" alt="Cellf"></p>
<p>Cellf is an interactive experiment that reflects you and your surroundings as
you play.</p>
<p>More simply put, it’s a twist on sliding tile games written in ClojureScript,
React (via Om), and core.async.</p>
<p><a href="https://rawgit.com/dmotz/cellf/gh-pages/index.html">Try it</a> for yourself.</p>
</div><div class="tools">Clojure, React, Om, core.async</div><br class="clear"></article><article id="content-chaincal"><h1>ChainCal</h1><h2>The simple habit building app for iPhone.</h2><div class="images"><img src="/assets/images/chaincal1.jpg"><img src="/assets/images/chaincal2.jpg"></div><div class="buttons"><a href="http://chaincalapp.com" class="button">chaincalapp.com</a><a href="http://itunes.apple.com/us/app/chaincal/id499195302" class="button">download on app store</a></div><div class="content"><p>Set daily goals and visualize your progress in an intuitive and visual way.
Motivate yourself to adopt new positive habits one day at a time.</p>
</div><div class="tools">CoffeeScript / JavaScript, Apache Cordova, CSS3, Objective-C</div><br class="clear"></article><article id="content-hexaflip"><h1>HexaFlip</h1><h2>Visualize arrays as cubes.</h2><div class="images"><img src="/assets/images/hexaflip1.jpg"><img src="/assets/images/hexaflip2.jpg"></div><div class="buttons"><a href="http://oxism.com/hexaflip" class="button">demo / docs</a><a href="https://github.com/dmotz/hexaflip" class="button">github</a><a href="http://tympanus.net/codrops/2013/03/07/hexaflip-a-flexible-3d-cube-plugin/" class="button">codrops article</a></div><div class="content"><p>Transform arrays of any length into cubes that can be rotated infinitely.
Originally developed as the time picking interface for <a href="#chaincal">ChainCal</a>, I expanded it to visualize arbitrary arrays and
wrote an article detailing the process on
<a href="http://tympanus.net/codrops/2013/03/07/hexaflip-a-flexible-3d-cube-plugin/">
Codrops</a>.</p>
</div><div class="tools">CoffeeScript / JavaScript, CSS3</div><br class="clear"></article><article id="content-maskew"><h1>Maskew</h1><h2>Add some diagonal rhythm to your elements.</h2><div class="images"><img src="/assets/images/maskew1.jpg"><img src="/assets/images/maskew2.jpg"></div><div class="buttons"><a href="http://oxism.com/maskew" class="button">demo / docs</a><a href="https://github.com/dmotz/maskew" class="button">github</a></div><div class="content"><p>Skew the shapes of elements without distorting their contents. Maskew creates a
parallelogram mask over the element and supports touch/mouse manipulation of the
skew amount.</p>
</div><div class="tools">CoffeeScript / JavaScript, CSS3</div><br class="clear"></article><article id="content-turingtype"><h1>TuringType</h1><h2>A naïve human typing simulation effect.</h2><div class="buttons"><a href="http://oxism.com/TuringType" class="button">demo / docs</a><a href="https://github.com/dmotz/TuringType" class="button">github</a></div><div class="content"><p>Written quickly to scratch an itch; not intended to be an accurate algorithm.</p>
<p>Watch the <a href="http://oxism.com/TuringType">demo</a> to see what it does.</p>
<p>Usage:</p>
<pre><code class="lang-javascript">new TuringType(domElement, &#39;Just some text.&#39;);
</code></pre>
<p>With some options:</p>
<pre><code class="lang-javascript">new TuringType(domElement, &#39;Terrible but fast typist.&#39;, {
  accuracy: 0.3,
  interval: 20,
  callback: allDone
});
</code></pre>
<p>Have fun.</p>
</div><div class="tools">CoffeeScript / JavaScript</div><br class="clear"></article><article id="content-natal"><h1>Natal</h1><h2>Bootstrap ClojureScript-based React Native apps.</h2><div class="buttons"><a href="https://github.com/dmotz/natal" class="button">github</a></div><div class="content"><p>Natal is a simple command-line utility that automates most of the process of
setting up a React Native app running on ClojureScript.</p>
<p>It stands firmly on the shoulders of giants, specifically those of
<a href="http://blog.fikesfarm.com">Mike Fikes</a> who created
<a href="https://github.com/omcljs/ambly">Ambly</a> and the
<a href="http://cljsrn.org/ambly.html">documentation</a>
on setting up a ClojureScript React Native app.</p>
<h2 id="usage">Usage</h2>
<p>Before getting started, make sure you have the
<a href="#dependencies">required dependencies</a> installed.</p>
<p>Then, install the CLI using npm:</p>
<pre><code>$ npm install -g natal
</code></pre><p>To bootstrap a new app, run <code>natal init</code> with your app’s name as an argument:</p>
<pre><code>$ natal init FutureApp
</code></pre><p>If your app’s name is more than a single word, be sure to type it in CamelCase.
A corresponding hyphenated Clojure namespace will be created.</p>
<p>By default Natal will create a simple skeleton based on the current stable
version of <a href="http://omcljs.org">Om</a> (aka Om Now). If you’d like to base your app
upon Om Next, you can specify a React interface template during init:</p>
<pre><code>$ natal init FutureApp --interface om-next
</code></pre><p>Keep in mind your app isn’t limited to the React interfaces Natal provides
templates for; these are just for convenience.</p>
<p>If all goes well your app should compile and boot in the simulator.</p>
<p>From there you can begin an interactive workflow by starting the REPL.</p>
<pre><code>$ cd future-app
$ rlwrap natal repl
</code></pre><p>(If you don’t have <code>rlwrap</code> installed, you can simply run <code>natal repl</code>, but
using <code>rlwrap</code> allows the use of arrow keys).</p>
<p>If there are no issues, the REPL should connect to the simulator automatically.
To manually choose which device it connects to, you can run <code>rlwrap natal repl --choose</code>.</p>
<p>At the prompt, try loading your app’s namespace:</p>
<pre><code class="lang-clojure">(in-ns &#39;future-app.core)
</code></pre>
<p>Changes you make via the REPL or by changing your <code>.cljs</code> files should appear live
in the simulator.</p>
<p>Try this command as an example:</p>
<pre><code class="lang-clojure">(swap! app-state assoc :text &quot;Hello Native World&quot;)
</code></pre>
<p>When the REPL connects to the simulator it will begin to automatically log
success messages, warnings, and errors whenever you update your <code>.cljs</code> files.</p>
<h2 id="tips">Tips</h2>
<ul>
<li><p>Having <code>rlwrap</code> installed is optional but highly recommended since it makes
the REPL a much nicer experience with arrow keys.</p>
</li>
<li><p>Don’t press ⌘-R in the simulator; code changes should be reflected automatically.
See <a href="https://github.com/omcljs/ambly/issues/97">this issue</a> in Ambly for details.</p>
</li>
<li><p>Running multiple React Native apps at once can cause problems with the React
Packager so try to avoid doing so.</p>
</li>
<li><p>You can launch your app on the simulator without opening Xcode by running
<code>natal launch</code> in your app’s root directory.</p>
</li>
<li><p>By default new Natal projects will launch on the iPhone 6 simulator. To change
which device <code>natal launch</code> uses, you can run <code>natal listdevices</code> to see a list
of available simulators, then select one by running <code>natal setdevice</code> with the
index of the device on the list.</p>
</li>
<li><p>To change advanced settings run <code>natal xcode</code> to quickly open the Xcode project.</p>
</li>
<li><p>The Xcode-free workflow is for convenience. If you’re encountering app crashes,
you should open the Xcode project and run it from there to view errors.</p>
</li>
<li><p>You can run any command with <code>--verbose</code> or <code>-v</code> to see output that may be
helpful in diagnosing errors.</p>
</li>
</ul>
<h2 id="dependencies">Dependencies</h2>
<p>As Natal is the orchestration of many individual tools, there are quite a few dependencies.
If you’ve previously done React Native or Clojure development, you should hopefully
have most installed already. Platform dependencies are listed under their respective
tools.</p>
<ul>
<li><a href="https://www.npmjs.com">npm</a> <code>&gt;=1.4</code><ul>
<li><a href="https://nodejs.org">Node.js</a> <code>&gt;=4.0.0</code></li>
</ul>
</li>
<li><a href="http://leiningen.org">Leiningen</a> <code>&gt;=2.5.3</code><ul>
<li><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java 8</a></li>
</ul>
</li>
<li><a href="https://cocoapods.org">CocoaPods</a> <code>&gt;=0.38.2</code><ul>
<li><a href="https://www.ruby-lang.org">Ruby</a> <code>&gt;=2.0.0</code></li>
</ul>
</li>
<li><a href="https://developer.apple.com/xcode">Xcode</a> (+ Command Line Tools) <code>&gt;=6.3</code><ul>
<li><a href="http://www.apple.com/osx">OS X</a> <code>&gt;=10.10</code></li>
</ul>
</li>
<li><a href="https://facebook.github.io/watchman">Watchman</a> <code>&gt;=3.7.0</code></li>
<li><a href="http://utopia.knoware.nl/~hlub/uck/rlwrap/">rlwrap</a> <code>&gt;=0.42</code> (optional but recommended for REPL use)</li>
<li><a href="https://www.npmjs.com/package/react-native-cli">react-native-cli</a> <code>&gt;=0.1.7</code> (install with <code>npm install -g react-native-cli</code>)</li>
</ul>
<h2 id="updating-natal">Updating Natal</h2>
<p>You can get the latest version of Natal by running <code>npm install -g natal</code> again.</p>
<h2 id="aspirations">Aspirations</h2>
<ul>
<li>[x] Xcode-free workflow with CLI tools</li>
<li>[x] Templates for other ClojureScript React wrappers</li>
<li>[x] Automatic wrapping of all React Native component functions for ClojureScript</li>
<li>[x] Automatically tail compilation log and report errors to REPL</li>
<li>[ ] Automatically run React packager in background</li>
<li>[ ] Working dev tools</li>
<li>[ ] Automatic bundling for offline device usage and App Store distribution</li>
<li>[ ] Android support</li>
</ul>
<h2 id="example-apps-bootstrapped-with-natal">Example apps bootstrapped with Natal</h2>
<ul>
<li><p><a href="https://github.com/dvcrn/om-react-native-demo">Om Next app with Python server</a>
by David Mohl, demonstrated in
<a href="https://www.youtube.com/watch?v=oJ8t8Hc9XaE">a talk at the Tokyo iOS Meetup</a>.</p>
</li>
<li><p><a href="https://github.com/iamjarvo/zooborns">Zooborns</a>
by Jearvon Dharrie, demonstrated in
<a href="https://www.youtube.com/watch?v=GDA-g6Ca_dQ">a talk at Clojure/conj 2015</a>.</p>
</li>
</ul>
<h2 id="coda">Coda</h2>
<p>Contributions are welcome.</p>
<p>For more ClojureScript React Native resources visit <a href="http://cljsrn.org">cljsrn.org</a>.</p>
<p>If you’re looking for a simple ClojureScript wrapper around the React Native API,
check out the companion library <a href="https://github.com/dmotz/natal-shell">Natal Shell</a>.
It is included by default in projects generated by Natal.</p>
</div><div class="tools">Clojure, CoffeeScript / JavaScript</div><br class="clear"></article><article id="content-taxa"><h1>Taxa</h1><h2>A tiny language inside JavaScript to enforce type signatures.</h2><div class="buttons"><a href="https://github.com/dmotz/taxa" class="button">github</a></div><div class="content"><pre><code class="lang-javascript">// denotes that add() accepts two numbers and returns a third:
add = t(&#39;n,n n&#39;, function(a, b) { return a + b });
add(3, 7);
// =&gt; 10
add(&#39;3&#39;, &#39;7&#39;);
// =&gt; Taxa: Expected number as argument 0, given string (3) instead.
</code></pre>
<p>Taxa is a small metaprogramming experiment that introduces a minimal grammar for
type annotations to JavaScript (and by extension, CoffeeScript).</p>
<p>Unlike other projects of this nature, Taxa is purely a runtime type checker
rather than a static analyzer. When a Taxa-wrapped function receives or returns
arguments of the wrong type, an exception is thrown.</p>
<p>Further unlike other type declaration projects for JavaScript, Taxa’s DSL lives
purely within the syntax of the language. There is no intermediary layer and no
preprocessing is required.</p>
<h2 id="grammar">Grammar</h2>
<p>Taxa type signatures are intended to be quick to type and to occupy few additional
columns in your code.</p>
<p>Following this spirit of brevity, examples are also shown in CoffeeScript as it’s
a natural fit to Taxa’s style.</p>
<p>In the following, Taxa is aliased as <code>t</code> (though <code>$</code> or <code>taxa</code> feel natural as well):</p>
<pre><code class="lang-coffeescript">t = require &#39;taxa&#39;
# or in a browser without a module loader:
t = window.taxa
</code></pre>
<pre><code class="lang-javascript">var t = require(&#39;taxa&#39;);
// or in a browser without a module loader:
var t = window.taxa;
</code></pre>
<p>A type signature is composed of two halves: the argument types and the return
type, separated by a space.</p>
<pre><code class="lang-coffeescript">pluralize = t &#39;String String&#39;, (word) -&gt; word + &#39;s&#39;
</code></pre>
<pre><code class="lang-javascript">var pluralize = t(&#39;String String&#39;, function(word) {
  return word + &#39;s&#39;;
});
</code></pre>
<p>The above signature indicates a function that expects a single string argument
and is expected to return a string as a result. If any other types are passed to
it, an informative error will be thrown:</p>
<pre><code class="lang-coffeescript">pluralize 7
# =&gt; Taxa: Expected string as argument 0, given number (7) instead.
</code></pre>
<pre><code class="lang-javascript">pluralize(7);
// =&gt; Taxa: Expected string as argument 0, given number (7) instead.
</code></pre>
<h3 id="shorthand">Shorthand</h3>
<p>Taxa provides a shorthand for built-in types, indicated by their first letter.
The following is equivalent to the previous example:</p>
<pre><code class="lang-coffeescript">exclaim = t &#39;s s&#39;, (word) -&gt; word + &#39;!&#39;
</code></pre>
<pre><code class="lang-javascript">var exclaim = t(&#39;s s&#39;, function(word) {
  return word + &#39;!&#39;;
});
</code></pre>
<p>Capital letter shorthand works as well:</p>
<pre><code class="lang-coffeescript">exclaim = t &#39;S S&#39;, (word) -&gt; word + &#39;!&#39;
</code></pre>
<pre><code class="lang-javascript">var exclaim = t(&#39;S S&#39;, function(word) {
  return word + &#39;!&#39;;
});
</code></pre>
<p>The shorthand mapping is natural, with the exception of <code>null</code>:</p>
<ul>
<li><code>0 =&gt; null</code></li>
<li><code>a =&gt; array</code></li>
<li><code>b =&gt; boolean</code></li>
<li><code>f =&gt; function</code></li>
<li><code>n =&gt; number</code></li>
<li><code>o =&gt; object</code></li>
<li><code>s =&gt; string</code></li>
<li><code>u =&gt; undefined</code></li>
</ul>
<p>Multiple arguments are separated by commas:</p>
<pre><code class="lang-coffeescript">add = t &#39;n,n n&#39;, (a, b) -&gt; a + b
</code></pre>
<pre><code class="lang-javascript">var add = t(&#39;n,n n&#39;, function(a, b) {
  return a + b;
});
</code></pre>
<p>The above function is expected to take two numbers as arguments and return a third.</p>
<h3 id="ignores">Ignores</h3>
<p>Occasionally you may want to ignore type checking on a particular argument.
Use the <code>_</code> character to mark it as ignored in the signature. For example, you may
have a method that produces effects without returning a value:</p>
<pre><code class="lang-coffeescript">Population::setCount = t &#39;n _&#39;, (@count) -&gt;
</code></pre>
<pre><code class="lang-javascript">Population.prototype.setCount = t(&#39;n _&#39;, function(count) {
  this.count = count;
});
</code></pre>
<p>Or a function that computes a result without input:</p>
<pre><code class="lang-coffeescript">t &#39;_ n&#39;, -&gt; Math.PI / 2
</code></pre>
<pre><code class="lang-javascript">t(&#39;_ n&#39;, function() {
  return Math.PI / 2;
});
</code></pre>
<h3 id="optionals">Optionals</h3>
<p>Similarly you can specify arguments as optional and their type will only be
checked if a value is present:</p>
<pre><code class="lang-coffeescript">t &#39;s,n? n&#39;, (string, radix = 10) -&gt; parseInt string, radix
</code></pre>
<pre><code class="lang-javascript">t(&#39;s,n? n&#39;, function(string, radix) {
  if (radix == null) {
    radix = 10;
  }
  return parseInt(string, radix);
});
</code></pre>
<h3 id="ors">Ors</h3>
<p>For polymorphic functions that accept different types of arguments, you can use
the <code>|</code> character to separate types.</p>
<pre><code class="lang-coffeescript">combine = t &#39;n|s,n|s n|s&#39;, (a, b) -&gt; a + b
</code></pre>
<pre><code class="lang-javascript">var combine = t(&#39;n|s,n|s n|s&#39;, function(a, b) {
  return a + b;
});
</code></pre>
<p>For each argument and return type in the above function, either a number or a
string is accepted.</p>
<h2 id="complex-types">Complex Types</h2>
<p>If you’d like to enforce types that are more specific than primitives, objects,
and arrays, you’re free to do so:</p>
<pre><code class="lang-coffeescript">makeDiv = t &#39;_ HTMLDivElement&#39;, -&gt; document.createElement &#39;div&#39;
</code></pre>
<pre><code class="lang-javascript">var makeDiv = t(&#39;_ HTMLDivElement&#39;, function() {
  return document.createElement(&#39;div&#39;);
});
</code></pre>
<hr>
<pre><code class="lang-coffeescript">makeBuffer = t &#39;n Buffer&#39;, (n) -&gt; new Buffer n
</code></pre>
<pre><code class="lang-javascript">var makeBuffer = t(&#39;n Buffer&#39;, function(n) {
  return new Buffer(n);
});
</code></pre>
<p>Since all non-primitive types are objects, specifying <code>o</code> in your signatures will
of course match complex types as well. However, passing a plain object or an
object of another type to a function that expects a specific type (e.g. <code>WeakMap</code>)
will correctly throw an error.</p>
<p>Keep in mind that Taxa is strict with these signatures and will not walk up an
object’s inheritance chain to match ancestral types.</p>
<h2 id="partial-application">Partial Application</h2>
<p>Like any other function, those annotated with Taxa carry a <code>bind</code> method, which
works as expected with the additional promise of modifying the output function’s
Taxa signature.</p>
<p>For example:</p>
<pre><code class="lang-coffeescript">add  = t &#39;n,n n&#39;, (a, b) -&gt; a + b
add2 = add.bind @, 2
add2 3
# =&gt; 5
</code></pre>
<pre><code class="lang-javascript">var add = t(&#39;n,n n&#39;, function(a, b) {
  return a + b;
});
var add2 = add.bind(this, 2);
add2(3);
// =&gt; 5
</code></pre>
<p>Under the covers, <code>add2</code>‘s type signature was changed to <code>n n</code>.</p>
<h2 id="aliases">Aliases</h2>
<p>You can add your own custom shorthand aliases like this:</p>
<pre><code class="lang-coffeescript">t.addAlias &#39;i8&#39;, &#39;Int8Array&#39;
</code></pre>
<pre><code class="lang-javascript">t.addAlias(&#39;i8&#39;, &#39;Int8Array&#39;);
</code></pre>
<p>And remove them as well:</p>
<pre><code class="lang-coffeescript">t.removeAlias &#39;i8&#39;
</code></pre>
<pre><code class="lang-javascript">t.removeAlias(&#39;i8&#39;);
</code></pre>
<h2 id="disabling">Disabling</h2>
<p>You can disable Taxa’s type enforcement behavior globally by calling <code>t.disable()</code>
(where <code>t</code> is whatever you’ve aliased Taxa as). This will cause calls to <code>t()</code> to
perform a no-op wherein the original function is returned unmodified.</p>
<p>This is convenient for switching between environments without modifying code.</p>
<p>Its counterpart is naturally <code>t.enable()</code>.</p>
<h2 id="further-examples">Further Examples</h2>
<p>Take a look at the test cases in <code>./test/main.coffee</code> for more examples of
Taxa signatures.</p>
<h2 id="caveats">Caveats</h2>
<p>When a function is modified by Taxa, its arity is not preserved as most JS
environments don’t allow modifying a function’s length property. Workarounds to
this problem would involve using the <code>Function</code> constructor which would introduce
its own problems. This only has implications if you’re working with higher order
functions that work by inspecting arity.</p>
<p>It should go without saying, but this library is experimental and has obvious
performance implications.</p>
<p>Taxa is young and open to suggestions / contributors.</p>
<h2 id="name">Name</h2>
<p>From the Ancient Greek τάξις (arrangement, order).</p>
</div><div class="tools">CoffeeScript / JavaScript</div><br class="clear"></article><article id="content-stream-snitch"><h1>stream-snitch</h1><h2>Event emitter for watching text streams with regex patterns.</h2><div class="buttons"><a href="https://github.com/dmotz/stream-snitch" class="button">github</a></div><div class="content"><p>stream-snitch is a tiny Node module that allows you to match streaming data
patterns with regular expressions. It’s much like <code>... | grep</code>, but for Node
streams using native events and regular expression objects. It’s also a good
introduction to the benefits of streams if you’re unconvinced or unintroduced.</p>
<h3 id="use-cases">Use Cases</h3>
<p>The most obvious use case is scraping or crawling documents from an external
source.</p>
<p>Typically you might buffer the incoming chunks from a response into a string
buffer and then inspect the full response in the response’s <code>end</code> callback.</p>
<p>For instance, if you had a function intended to download all image URLs embedded
in a document:</p>
<pre><code class="lang-javascript">function scrape(url, fn, cb) {
  http.get(url, function(res) {
    var data = &#39;&#39;;
    res.on(&#39;data&#39;, function(chunk) { data += chunk });
    res.on(&#39;end&#39;, function() {
      var rx = /&lt;img.+src=[&quot;&#39;](.+)[&#39;&quot;].?&gt;/gi, src;
      while (src = rx.exec(data)) fn(src);
      cb();
    });
  });
}
</code></pre>
<p>Of course, the response could be enormous and bloat your <code>data</code> buffer. What’s
worse is the response chunks could come slowly and you’d like to perform
hundreds of these download tasks concurrently and get the job done as quickly as
possible. Waiting for the entire response to finish negates part of the
asynchronous benefits Node’s model offers and mainly ignores the fact that the
response is a stream object that represents the data in steps as they occur.</p>
<p>Here’s the same task with stream-snitch:</p>
<pre><code class="lang-javascript">function scrape(url, fn, cb) {
  http.get(url, function(res) {
    var snitch = new StreamSnitch(/&lt;img.+src=[&quot;&#39;](.+)[&#39;&quot;].?&gt;/gi);
    snitch.on(&#39;match&#39;, function(match) { fn(match[1]) });
    res.pipe(snitch);
    res.on(&#39;end&#39;, cb)
  });
}
</code></pre>
<p>The image download tasks (represented by <code>fn</code>) can occur as sources are found
without having to wait for a potentially huge or slow request to finish first.
Since you specify native regular expressions, the objects sent to <code>match</code>
listeners will contain capture group matches as the above demonstrates
(<code>match[1]</code>).</p>
<p>For crawling, you could match <code>href</code> properties and recursively pipe their
responses through more stream-snitch instances.</p>
<p>Here’s another example (in CoffeeScript) from
<a href="https://github.com/dmotz/soundscrape">soundscrape</a> that matches data from
inline JSON:</p>
<pre><code class="lang-coffeescript">scrape = (page, artist, title) -&gt;
  http.get &quot;#{ baseUrl }#{ artist }/#{ title or &#39;tracks?page=&#39; + page }&quot;, (res) -&gt;
    snitch = new StreamSnitch /bufferTracks\.push\((\{.+?\})\)/g
    snitch[if title then &#39;once&#39; else &#39;on&#39;] &#39;match&#39;, (match) -&gt;
      download parse match[1]
      scrape ++page, artist, title unless ++trackCount % 10

    res.pipe snitch
</code></pre>
<h3 id="usage">Usage</h3>
<pre><code>$ npm install stream-snitch
</code></pre><p>Create a stream-snitch instance with a search pattern, set a <code>match</code> callback,
and pipe some data in:</p>
<pre><code class="lang-javascript">var fs           = require(&#39;fs&#39;),
    StreamSnitch = require(&#39;stream-snitch&#39;),
    albumList    = fs.createReadStream(&#39;./recently_played_(HUGE).txt&#39;),
    cosmicSnitch = new StreamSnitch(/^cosmic\sslop$/mgi);

cosmicSnitch.on(&#39;match&#39;, console.log.bind(console));
albumList.pipe(cosmicSnitch);
</code></pre>
<p>For the lazy, you can even specify the <code>match</code> event callback in the
instantiation:</p>
<pre><code class="lang-javascript">var words = new StreamSnitch(/\s(\w+)\s/g, function(m) { /* ... */ });
</code></pre>
<h3 id="caveats">Caveats</h3>
<p>stream-snitch is simple internally and uses regular expressions for flexibility,
rather than more efficient procedural parsing. The first consequence of this is
that it only supports streams of text and will decode binary buffers
automatically.</p>
<p>Since it offers support for any arbitrary regular expressions including capture
groups and start / end operators, chunks are internally buffered and examined
and discarded only when matches are found. When given a regular expression in
multiline mode (<code>/m</code>), the buffer is cleared at the start of every newline.</p>
<p>stream-snitch will periodically clear its internal buffer if it grows too large,
which could occur if no matches are found over a large amount of data or you use
an overly broad capture. There is the chance that legitimate match fragments
could be discarded when the water mark is reached unless you specify a large
enough buffer size for your needs.</p>
<p>The default buffer size is one megabyte, but you can pass a custom size like
this if you anticipate a very large capture size:</p>
<pre><code class="lang-javascript">new StreamSnitch(/.../g, { bufferCap: 1024 * 1024 * 20 });
</code></pre>
<p>If you want to reuse a stream-snitch instance after one stream ends, you can
manually call the <code>clearBuffer()</code> method.</p>
<p>It should be obvious, but remember to use the <code>m</code> (multiline) flag in your
patterns if you’re using the <code>$</code> operator for looking at endings on a line by
line basis. If you’re legitimately looking for a pattern at the end of a
document, stream-snitch only offers some advantage over buffering the entire
response, in that it periodically discards chunks from memory.</p>
</div><div class="tools">Node.js</div><br class="clear"></article><article id="content-ear-pipe"><h1>ear-pipe</h1><h2>Pipe audio streams to your ears.</h2><div class="buttons"><a href="https://github.com/dmotz/ear-pipe" class="button">github</a></div><div class="content"><h3 id="concept">Concept</h3>
<p>ear-pipe is a duplex stream that allows you to pipe any streaming audio data to
your ears (by default), handling any decoding automatically for most formats.
You can also leverage this built-in decoding by specifying an output encoding
and pipe the output stream somewhere else.</p>
<h3 id="installation">Installation</h3>
<p>ear-pipe relies on the cross-platform audio utility
<a href="http://sox.sourceforge.net">SoX</a>, so make sure that’s installed first.</p>
<pre><code>$ npm install --save ear-pipe
</code></pre><h3 id="usage">Usage</h3>
<pre><code class="lang-javascript">var EarPipe = require(&#39;ear-pipe&#39;),
    ep      = new EarPipe(/* &lt;type&gt;, &lt;bitrate&gt;, &lt;transcode-type&gt; */);
</code></pre>
<p>When arguments are omitted (e.g. <code>ep = new EarPipe;</code>), the type defaults to
<code>&#39;mp3&#39;</code>, the bitrate defaults to <code>16</code>, and the third argument is <code>null</code>
indicating that the pipe destination is your ears rather than a transcoded
stream.</p>
<p>If your input encoding isn’t mp3, make sure you set it to one of the formats
supported by SoX:</p>
<pre><code>8svx aif aifc aiff aiffc al amb au avr cdda cdr cvs cvsd cvu dat dvms f32 f4 f64
f8 fssd gsm gsrt hcom htk ima ircam la lpc lpc10 lu maud mp2 mp3 nist prc raw s1
s16 s2 s24 s3 s32 s4 s8 sb sf sl sln smp snd sndr sndt sou sox sph sw txw u1 u16
u2 u24 u3 u32 u4 u8 ub ul uw vms voc vox wav wavpcm wve xa
</code></pre><h3 id="examples">Examples</h3>
<h4 id="http-stream">HTTP Stream</h4>
<p>Let’s pipe some <a href="http://en.wikipedia.org/wiki/Number_stations">number station</a>
audio to our ears right as it comes off the wire:</p>
<pre><code class="lang-javascript">http.get(
  &#39;http://ia700500.us.archive.org/12/items/ird059/tcp_d1_06_the_lincolnshire_poacher_mi5_irdial.mp3&#39;,
  function(res) { res.pipe(new EarPipe) });
</code></pre>
<p>If your connection and speakers work, you should hear it as it downloads.</p>
<h4 id="nondeterministic-dj-set">Nondeterministic DJ Set</h4>
<p>Let’s send multiple audio streams to the same ear-pipe:</p>
<pre><code class="lang-javascript">var ep      = new EarPipe,
    telstar = fs.createReadStream(&#39;./telstar.mp3&#39;),
    cream   = fs.createReadStream(&#39;./cream.mp3&#39;);

http.get(&#39;http://127.0.0.1/sirens.mp3&#39;, function(res) { res.pipe(ep) });
telstar.pipe(ep);
cream.pipe(ep);
</code></pre>
<p>Since only one chunk passes through at a time, this DJ set should have plenty of
cuts.</p>
<h4 id="transcode">Transcode</h4>
<p>Since we’re decoding the audio on the fly, we can specify that we’d like to use
that output for another destination besides our ears:</p>
<pre><code class="lang-javascript">// null arguments mean defaults, true implies default output encoding (wav)
var ep    = new EarPipe(null, null, true),
    hotel = fs.createReadStream(&#39;./hotel.mp3&#39;);

hotel.pipe(ep).pipe(fs.createWriteStream(&#39;./hotel.wav&#39;));
</code></pre>
<p>Or pipe to another process:</p>
<pre><code class="lang-javascript">var ep      = new EarPipe(&#39;wav&#39;),
    epTrans = new EarPipe(null, null, true),
    audio   = someStreamingNetworkData();

audio.pipe(epTrans).pipe(ep);
epTrans.pipe(anotherStreamingAudioConsumer);
</code></pre>
<h3 id="killing">Killing</h3>
<p>Kill an ear-pipe instance by calling its <code>kill()</code> method. If you’re interested
in the underlying SoX process, access an instance’s <code>.process</code> property.</p>
</div><div class="tools">Node.js</div><br class="clear"></article><article id="content-statmap"><h1>statmap</h1><h2>Output recursive directory stats as JSON for visualization and analysis.</h2><div class="buttons"><a href="https://github.com/dmotz/statmap" class="button">github</a></div><div class="content"><h3 id="installation-and-usage">Installation and Usage</h3>
<p><strong>As a system executable:</strong></p>
<pre><code>$ npm install -g statmap
</code></pre><p>When used as an executable, statmap returns JSON over stdout.</p>
<p>To map the current directory:</p>
<pre><code>$ statmap &gt; stats.json
</code></pre><p>Pass an optional argument for a different directory:</p>
<pre><code>$ statmap .. &gt; parent.json
</code></pre><p>The JSON will contain a recursive representation of the directory and all
children. Each key is a file or directory name with a corresponding value
containing a <code>stats</code> object and a <code>children</code> object if it is a directory.
Directories also are also given a <code>sum</code> property which reflects the size of all
children recursively, unlike the typical <code>size</code> property of directory’s <code>stats</code>
object.</p>
<p>Here’s an excerpt of the output for the package itself:</p>
<pre><code class="lang-javascript">{
  &quot;statmap&quot;: {
    &quot;stats&quot;: {
      &quot;dev&quot;: 16777220,
      &quot;mode&quot;: 16877,
      &quot;nlink&quot;: 9,
      &quot;uid&quot;: 501,
      &quot;gid&quot;: 80,
      &quot;rdev&quot;: 0,
      &quot;blksize&quot;: 4096,
      &quot;ino&quot;: 141035615,
      &quot;size&quot;: 306,
      &quot;blocks&quot;: 0,
      &quot;atime&quot;: &quot;2013-11-25T01:02:05.000Z&quot;,
      &quot;mtime&quot;: &quot;2013-11-25T01:02:05.000Z&quot;,
      &quot;ctime&quot;: &quot;2013-11-25T01:02:05.000Z&quot;
    },
    &quot;sum&quot;: 165329,
    &quot;children&quot;: {
      &quot;README.md&quot;: {
        &quot;stats&quot;: {
          &quot;dev&quot;: 16777220,
          &quot;mode&quot;: 33188,
          &quot;nlink&quot;: 1,
          &quot;uid&quot;: 501,
          &quot;gid&quot;: 80,
          &quot;rdev&quot;: 0,
          &quot;blksize&quot;: 4096,
          &quot;ino&quot;: 141057002,
          &quot;size&quot;: 550,
          &quot;blocks&quot;: 8,
          &quot;atime&quot;: &quot;2013-11-25T01:02:05.000Z&quot;,
          &quot;mtime&quot;: &quot;2013-11-25T01:01:52.000Z&quot;,
          &quot;ctime&quot;: &quot;2013-11-25T01:01:54.000Z&quot;
        }
      },
      &quot;index.js&quot;: {
        &quot;stats&quot;: {
          &quot;dev&quot;: 16777220,
          &quot;mode&quot;: 33188,
          &quot;nlink&quot;: 1,
          &quot;uid&quot;: 501,
          &quot;gid&quot;: 80,
          &quot;rdev&quot;: 0,
          &quot;blksize&quot;: 4096,
          &quot;ino&quot;: 141035626,
          &quot;size&quot;: 1180,
          &quot;blocks&quot;: 8,
          &quot;atime&quot;: &quot;2013-11-25T01:02:06.000Z&quot;,
          &quot;mtime&quot;: &quot;2013-11-25T00:51:31.000Z&quot;,
          &quot;ctime&quot;: &quot;2013-11-25T00:51:31.000Z&quot;
        }
      },
      &quot;node_modules&quot;: {
        &quot;stats&quot;: {
          &quot;dev&quot;: 16777220,
          &quot;mode&quot;: 16877,
          &quot;nlink&quot;: 3,
          &quot;uid&quot;: 501,
          &quot;gid&quot;: 20,
          &quot;rdev&quot;: 0,
          &quot;blksize&quot;: 4096,
          &quot;ino&quot;: 141036545,
          &quot;size&quot;: 102,
          &quot;blocks&quot;: 0,
          &quot;atime&quot;: &quot;2013-11-25T00:53:55.000Z&quot;,
          &quot;mtime&quot;: &quot;2013-11-24T23:00:54.000Z&quot;,
          &quot;ctime&quot;: &quot;2013-11-24T23:00:54.000Z&quot;
        },
        &quot;sum&quot;: 124651,
        &quot;children&quot;: {
          &quot;async&quot;: {
            &quot;stats&quot;: {
        //...
</code></pre>
<p>Using this data, you could create something like a
<a href="http://mbostock.github.io/d3/talk/20111018/treemap.html">D3 zoomable treemap</a>
of your hard drive.</p>
<p><strong>As a library:</strong></p>
<pre><code>$ npm install --save statmap
</code></pre><p>Pass a path and a callback:</p>
<pre><code class="lang-javascript">var statmap = require(&#39;statmap&#39;);

statmap(&#39;./spells&#39;, function(err, stats) {
  console.log(utils.inspect(stats, { color: true, depth: null }));
});
</code></pre>
<p>When used as a library, a live object is returned rather than a JSON string.</p>
</div><div class="tools">Node.js</div><br class="clear"></article><article id="content-commune"><h1>Commune</h1><h2>Web workers lose their chains: Easy threads without separate function files.</h2><div class="buttons"><a href="https://github.com/dmotz/commune.js" class="button">github</a></div><div class="content"><p>Commune.js makes it easy to run computationally heavy functions in a separate
thread and retrieve the results asynchronously. By delegating these functions
to a separate thread, you can avoid slowing down the main thread that affects
the UI. Think of it as a way to leverage the web workers API without ever having
to think about the web workers API.</p>
<p>Using straightforward syntax, you can add web worker support to your app’s
functions without the need to create separate files (as web workers typically
require) and without the need to change the syntax of your functions. Best of
all, everything will work without problems on browsers that do not support web
workers.</p>
<h3 id="usage">Usage</h3>
<p>Here’s an example where the first argument is the function to thread, the second
argument is an array of arguments to pass to it, and the third is a callback to
handle the result once it comes through:</p>
<pre><code class="lang-javascript">var heavyFunction = function(a, b, c){
    // do some work 100 million times
    for(var i = 0; i &lt; 1e9; i++){
        a++;
        b++;
        c++;
    }
    // return arguments modified
    return [a, b, c];
}

commune(heavyFunction, [1, 2, 3], function(result){
    console.log(result); // [100000001, 100000002, 100000003]
});

//go ahead and continue with more work in the main thread without being held up:
console.log(&#39;I will appear before the loop finishes.&#39;);

setTimeout(function(){
    console.log(&#39;I probably will too, depending on how fast your CPU is.&#39;);
}, 500);
</code></pre>
<p>In a browser that supports worker threads, the above will output:</p>
<pre><code>I will appear before the loop finishes.
I probably will too, depending on how fast your CPU is.
[100000001, 100000002, 100000003]
</code></pre><p>In a browser without web worker support, everything still works, just in a
different order:</p>
<pre><code>[100000001, 100000002, 100000003]
I will appear before the loop finishes.
I probably will too, depending on how fast your CPU is.
</code></pre><p>With Commune.js, we could proceed with our work in the main thread without
waiting to loop 100 million times.</p>
<p>Further proof:</p>
<pre><code class="lang-javascript">commune(heavyFunction, [1, 2, 3], function(result){
    console.log(result); // [100000001, 100000002, 100000003]
});

commune(heavyFunction, [50, 60, 70], function(result){
    console.log(result); // [100000050, 100000060, 100000070]
});

commune(heavyFunction, [170, 180, 190], function(result){
    console.log(result); // [100000170, 100000180, 100000190]
});
</code></pre>
<p>Running the above in a browser with worker support, you’ll see the results of
each function call appear simultaneously, meaning that none of these large loops
had to wait for the others to finish before starting. Using Commune.js with
care, you can bring asynchronicity and parallelism to previously inapplicable
areas.</p>
<p>To simplify things more, you can DRY up your syntax with the help of
<code>communify()</code> which transforms your vanilla function into a Commune-wrapped
version:</p>
<pre><code class="lang-javascript">var abcs = function(n){
    var s = &#39;&#39;;
    for(var i = 0; i &lt; n; i++){
        s += &#39;abc&#39;;
    }
    return s;
}

// Communify the function for future calls:
abcs = communify(abcs);

// Or designate some partial application:
abcs = communify(abcs, [5]);

// Then call it later in a simplified manner:
abcs(function(s){
    console.log(&#39;my opus:&#39;, s);
});

// Even cleaner with named functions:
abcs(alert);

// If you didn&#39;t use partial application with the original communify call:
abcs([10], alert);
</code></pre>
<h3 id="how-it-works">How It Works</h3>
<p>When you pass a new function to Commune.js, it creates a modified version of the
function using web worker syntax. Commune.js memoizes the result so additional
calls using the same function don’t have to be rewritten.</p>
<p>Just write your functions as you normally would using return statements.</p>
<p>Commune.js automatically creates binary blobs from your functions that can be
used as worker scripts.</p>
<h3 id="caveats">Caveats</h3>
<p>Since web workers operate in a different context, you can’t reference any
variables outside of the function’s scope (including the DOM) and you can’t
use references to <code>this</code> since it will refer to the worker itself. For functions
you want to use Commune.js with, use a functional style where they return a
modified version of their input.</p>
<p>Also, since this is an abstraction designed for ease-of-use and flexibility,
it does not work exactly as web workers do – namely you can’t have multiple
return events from a single worker.</p>
</div><div class="tools">CoffeeScript / JavaScript, web workers</div><br class="clear"></article><article id="content-express-spa-router"><h1>Express SPA Router</h1><h2>Internally reroute non-AJAX requests to your client-side single page app router.</h2><div class="buttons"><a href="https://github.com/dmotz/express-spa-router" class="button">github</a></div><div class="content"><h3 id="concept">Concept</h3>
<p>Let’s say you have a modern single page web application with client-side URL
routing (e.g. Backbone).</p>
<p>Since views are rendered on the client, you’ll likely use RESTful Express routes
that handle a single concern and return only JSON back to the client. The app’s
only non-JSON endpoint is likely the index route (<code>/</code>).</p>
<p>So while <code>/users</code> might return a JSON array when hit via the client app’s AJAX
call, you’ll want to handle that request differently if the user clicks a link
from an external site or manually types it in the address bar. When hit in this
context, this middleware internally redirects the request to the index route
handler, so the same client-side app is loaded for every valid route. The URL
for the end user remains the same and the client-side app uses its own router to
show the user what’s been requested based on the route. This eliminates the
tedium of performing this kind of conditional logic within individual route
callbacks.</p>
<h3 id="installation">Installation</h3>
<pre><code>$ npm install --save express-spa-router
</code></pre><h3 id="usage">Usage</h3>
<p>In your Express app’s configuration, place this middleware high up the stack
(before <code>router</code> and <code>static</code>) and pass it your app instance:</p>
<pre><code class="lang-javascript">app.use(require(&#39;express-spa-router&#39;)(app));
</code></pre>
<p>AJAX requests will be untouched, but valid routes called without AJAX will
result in the the index route’s result being returned. Non-matching routes will
be passed down the stack by default and will be end up being handled by whatever
your app does with 404s. This can be overridden by passing a <code>noRoute</code> function
in the options object:</p>
<pre><code class="lang-javascript">app.use(require(&#39;express-spa-router&#39;)(app,
  {
    noRoute: function(req, res, next) {
      //handle unmatched route
    }
  }
));
</code></pre>
<p>Express’s default static paths are passed along correctly by default (as are
<code>/js</code> and <code>/css</code>), but if you use different paths or have additional static
files in your <code>public</code> directory, make sure to specify them in the options
either via a regular expression or an array of directory names:</p>
<pre><code class="lang-javascript">app.use(require(&#39;express-spa-router&#39;)(app, {staticPaths: [&#39;js&#39;, &#39;css&#39;, &#39;uploads&#39;]}));
</code></pre>
<p>You may also have valid client-side routes that don’t exist on the server-side.
Rather than having them reach the 404 handler, you can specify them in the
configuration options using <code>extraRoutes</code> and passing either a regular
expression or an array:</p>
<pre><code class="lang-javascript">app.use(require(&#39;express-spa-router&#39;)(app, {extraRoutes: [&#39;about&#39;, &#39;themes&#39;]}));
</code></pre>
<p>Finally, if you want to route non-AJAX <code>GET</code> requests to certain routes normally,
pass paths in the <code>ignore</code> option:</p>
<pre><code class="lang-javascript">app.use(require(&#39;express-spa-router&#39;)(app, {ignore: [&#39;api&#39;]}));
</code></pre>
</div><div class="tools">Node.js</div><br class="clear"></article><article id="content-monocat"><h1>Monocat</h1><h2>Automated asset inlining.</h2><div class="buttons"><a href="https://github.com/dmotz/monocat" class="button">github</a></div><div class="content"><p>Monocat is ideal for deploying small, static, single-page sites where you want
to minimize the number of http requests. Monocat compresses and writes the
contents of external assets into the html source for an easy speed optimization.</p>
<h3 id="installation-">Installation:</h3>
<p>You’ll need <a href="http://nodejs.org">Node.js</a> installed. Then:</p>
<pre><code>$ npm install -g monocat
</code></pre><h3 id="usage-">Usage:</h3>
<p>Monocat works sort of like a jQuery plugin, but from the commandline.</p>
<p>Just add the class <code>monocat</code> to any <code>&lt;script&gt;</code> or <code>&lt;link&gt;</code> (stylesheets only)
tag you want to inline:</p>
<pre><code class="lang-html">&lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css&quot; class=&quot;monocat&quot;&gt;
&lt;script src=&quot;js/huge-lib.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;js/main.js&quot; class=&quot;monocat&quot;&gt;&lt;/script&gt;
</code></pre>
<p>Notice that the second tag will be ignored since it lacks the <code>monocat</code> class.</p>
<p>To create an optimized version of your html file, run this:</p>
<pre><code>$ monocat index.html
</code></pre><p>By default, this will create a ready-to-deploy file called <code>index_monocat.html</code>
in the same directory.</p>
<p>Pass an optional output filename as the second argument:</p>
<pre><code>$ monocat src/index.html build/index.html
</code></pre></div><div class="tools">Node.js</div><br class="clear"></article></div></section><script>var jsonMap = {"oridomi":"OriDomi - Fold the DOM up like paper","gildedgauge":"Gilded Gauge - Visualize relative wealth in graspable terms","pozaic":"Pozaic - Capture one second moments as animated gif mosaics","exifexodus":"ExifExodus - Remove GPS data from your photos before you share them online","cellf":"Cellf - A game of reflection","chaincal":"ChainCal - The simple habit building app for iPhone","hexaflip":"HexaFlip - Visualize arrays as cubes","maskew":"Maskew - Add some diagonal rhythm to your elements","turingtype":"TuringType - A naïve human typing simulation effect","natal":"Natal - Bootstrap ClojureScript-based React Native apps","natal-shell":"Natal Shell - A thin ClojureScript wrapper around the React Native API","taxa":"Taxa - A tiny language inside JavaScript to enforce type signatures","stream-snitch":"stream-snitch - Event emitter for watching text streams with regex patterns","ear-pipe":"ear-pipe - Pipe audio streams to your ears","statmap":"statmap - Output recursive directory stats as JSON for visualization and analysis","commune":"Commune - Web workers lose their chains: Easy threads without separate function files","express-spa-router":"Express SPA Router - Internally reroute non-AJAX requests to your client-side single page app router","monocat":"Monocat - Automated asset inlining"};</script><script src="/assets/js/oxism.js?v=2087abf64f85f5660dcd1532f6724950"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-30392798-1', 'auto');
ga('send', 'pageview');</script></body></html>